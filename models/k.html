<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>work</title>
    <style>
			body { margin: 0; }
			canvas {
				display:block;
				width:100%;
				height:100%;
			 }
		</style>
  </head>
  <body>
    <script src="js/three.js"></script>
    <script src="js/OrbitControls.js"></script>
      <script src="js/physi.js"></script>
<script src="js/GLTFLoader.js"></script>




        <script>
//var p=[];

          Physijs.scripts.worker='js/physijs_worker.js';
          //Physijs.scripts.ammo='ammo.js';

          var scene=new Physijs.Scene;

         scene.setGravity(new THREE.Vector3(0,-10,0));
            //var scene=new THREE.Scene();
            //scene.background=new THREE.Color(0xdddddd);

            var camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,15000);
            //camera.rotation.y=45/180*Math.PI;
            camera.position.x=0;
            camera.position.y=0;
            camera.position.z=60;
            camera.lookAt(scene.position);


            var renderer=new THREE.WebGLRenderer({antialias:true});
            renderer.setClearColor(0xff0fff);
            renderer.setSize(window.innerWidth,window.innerHeight);
            document.body.appendChild(renderer.domElement);

            function addCube(){
            var loader=new THREE.TextureLoader();
            var texture=loader.load("textures/crate.gif");
            var cube=new THREE.CubeGeometry(7,7,7);
            var material=new THREE.MeshBasicMaterial({map:texture});
            var cubeobj=new Physijs.BoxMesh(cube,material);
            console.log(cubeobj);
            scene.add(cubeobj);
          }
          function addCar(x,group){
            var loader=new THREE.GLTFLoader();

            loader.load('models/scene.gltf',function(gltf){
              car=gltf.scene;


              car.scale.set(0.01,0.01,0.01);
              car.position.x=x;
              car.rotation.y=-29.9;
            //  scene.add(gltf.scene);
              group.add(car);
            });
}


var light=new THREE.AmbientLight(0xffffff,5);

scene.add(light);

//var controls=new THREE.OrbitControls(camera,renderer.domElement);

var k=1;
var carobj=new THREE.Group();

function update(){
  if(k){

    addCube();
    addCar(0,carobj);
    //carobj.add(camera);
    //carobj.position.x=10;


    camera.updateProjectionMatrix();
   scene.add(carobj);
   //carobj.rotation.x=30;
    k=0;
  }
  //carobj.position.x-=0.08;
  //camera.lookAt(carobj.position);


  scene.simulate();
  //controls.update();
}
  function animate(){
  update();
  renderer.render(scene,camera);
  requestAnimationFrame(animate);
}


requestAnimationFrame(animate);
        </script>


  </body>
</html>
